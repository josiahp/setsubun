pico-8 cartridge // http://www.pico-8.com
version 39
__lua__
function _init()
 t=time()
 --dad is 24 pixels tall, so
 -- 1.5m == 24px
 -- 9.8m == 156px?
 gravity=9.81*2
 dt=0
 drag=0.1
 dad=init_dad(63,63)
 beans_init()
 bg=beans_new(63,63,5)
end

function _update()
 local tt=time()
 dt=tt-t
 t=tt
 
 dad:update(dt)
 --beans:update(dt)
 bg:update(dt)
end

function _draw()
 cls()
 --dad:draw()
 bg:draw()
end
-->8
--dad

function init_dad(x,y)
 local dad={
  x=63,
  y=63,
  spd=50,
  update=function(d,dt)
   local vx,vy=0,0
   if btn(⬅️) then
    vx-=d.spd
   elseif btn(➡️) then
    vx+=d.spd
   end
   d.x+=vx*dt
   d.y+=vy*dt
  end,
  draw=function(d)
   spr(1,d.x,d.y,2,3,false,false)
  end,
 }
 return dad
end
-->8

-->8
--beans
function beans_init()
 beans_proto={
  update=function(b,dt)
   for k,v in pairs(b.group) do
    if not v.grounded then
	    --gravity
	    v.vy+=gravity*dt
	   end
   
    if v.y+v.vy*dt>=127 then
     v.vy*=-1
    end
    
    v.vx*=1-drag
    v.vy*=1-drag
    
    if abs(v.vy)<1 and abs(127-v.y+v.vy)<5 then
     v.y=127
     v.vy=0
     v.grounded=true
    end

    v.y+=v.vy
    v.x+=v.vx
   end   
  end,
  draw=function(b)
   for k,v in pairs(b.group) do
    spr(3,v.x-4,v.y-4)
   end
  end,
 }
 beans_meta={__index=beans_proto}
end

function beans_new(x,y,n)
 local beans={
  group={},
 }
 for n=1,n do
  add(beans.group,{
   x=x+rnd(10)-5,
   y=y+rnd(10)-5,
   vx=rnd(3)+3,
   vy=-rnd(5)-4,
   grounded=false,
  })
 end
 setmetatable(beans,beans_meta)
 return beans
end
__gfx__
00000000000077000077000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000077000077000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
007007000007ee7007ee70000004f000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000770000007ee7007ee700000f4ff00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000770000007ee7777ee700000ff4f00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
007007000007ee7777ee7000000ff000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000007777777777770000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000077777777777777000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000077777777777777000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000077777777777777000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000077777777777777000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000007777777777770000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000677777777600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000767777776700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000007776666667770000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000007777777777770000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000007777777777770000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000777777777700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000777777777700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000777777777700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000077700777000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000077700777000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000777700777700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000777000077700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
